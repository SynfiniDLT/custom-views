## Quickstart - Custom Views
This project contains an example using the custom views library to project ledger events to a PostgreSQL table. If you 
are not familiar with IOUs, please read the [IOU overview](https://docs.daml.com/app-dev/bindings-java/quickstart.html#tutorials-iou-overview).

The example provides a script in `ProjectionRunner.java` to start the projection. It also provides a spring-boot
application with a REST API over the projected events in the database.

Note: Before starting, please ensure you have the Daml SDK installed. You can find instructions on how to do that [here](https://docs.daml.com/getting-started/installation.html#installing-the-sdk)

# How to run
- Compile Daml model with `daml build`
- Startup a sandbox ledger with `daml sandbox --dar .daml/dist/quickstart-0.0.1.dar`
- Initialise ledger with some parties with `daml script --dar .daml/dist/quickstart-0.0.1.dar --script-name Main:initialize --ledger-host localhost --ledger-port 6865 --static-time --output-file parties.json`
- Generate java code from daml source with `daml codegen java`
- Start Navigator with `daml navigator server`
- Run `docker-compose up -d db` to spin up postgres database
- Connect to the postgres dabase and create a new database named `ious`. 
- Start the REST API `./mvnw spring-boot:run`
- Find the file `parties.json` generated by `daml script` command above and copy the party of alice string from the file. It should be the first item of the array (e.g. Alice::...)
- Start the projection runner `./mvnw exec:java -Dexec.mainClass="com.daml.quickstart.iou.ProjectionRunner" -Dexec.args="<party of alice>"`

You should be able to see events projected to the database by checking the database directly or using one of the APIs below.
- `GET /events`
- `GET /events/count`
